<%- include('../components/common/head.ejs', { pageTitle: pageTitle }) %>
  <link rel="stylesheet" href="/styles/navbar.css">
  <link rel="stylesheet" href="/styles/socialbar.css">
  <script src="/scripts/navbar.js" defer></script>
  <link rel="stylesheet" href="/styles/gestor_peticiones.css">
  <script src="/scripts/gestor-peticiones.js" defer></script>
  </head>

  <body>
    <script>
      window.idUsuario = <%=userId %>
    </script>
    <main>
      <h2 class="titulo_seccion">
      </h2>
      <div class="div-container">
        <!--<button id="mostrarFormPeticiones" class="btn">Añadir nueva petición</button>
        <form action="/gestor-peticiones/agregarPeticion" method="POST" id="peticionesForm" style="display: none;">
          <label for="tipo">tipo:</label>
          <input type="text" name="tipo" id="tipo" required>
          <label for="usuario">Usuario:</label>
          <input type="text" name="usuario" id="usuario" required>
          <label for="estado">Estado:</label>
          <input type="text" name="estado" id="estado" required>
          <label for="comentarios">Comentarios:</label>
          <input type="text" name="comentarios" id="comentarios" required>
          <label for="asignadaa">Asignadaa:</label>
          <input type="text" name="asignadaa" id="asignadaa" required>
          <button type="submit" class="btn">Añadir</button>
        </form>
        <label>Buscar registro... </label><input type="text" id="search" class="search-input" placeholder="Buscar">-->
        <div id="filter-buttons">
          <button data-status="all" class="filter-button all active">Todas (<span class="badge"><%= numeroPeticiones %></span>)</button>
          <button data-status="pending" class="filter-button pending">Pendientes (<span class="badge"><%= numeroPendientes %></span>)</button>
          <button data-status="tasks" class="filter-button tasks">Asignadas (<span class="badge"><%= numeroAsignadas %></span>)</button>
          <button data-status="approved" class="filter-button approved">Aprobadas (<span class="badge"><%= numeroAprobadas %></span>)</button>
          <button data-status="rejected" class="filter-button rejected">Rechazadas (<span class="badge"><%= numeroRechazadas %></span>)</button> 
          <button data-status="assigned-to-me" class="filter-button assigned-to-me">Mis tareas (<span class="badge"><%= asignadasAMi %></span>)</button>
        </div>
        <div class="table-container">

          <div id="petitions-container">
            <% for(let peticion of peticiones) { %>
              <div class="petition-card" data-priority="<%= peticion.prioridad %>" data-status="<%= peticion.estado %>"
                data-assigned-to="<%= peticion.asignadaId%>">
                <h3>
                  <%= peticion.nombre %>
                </h3>
                <img src="<%= peticion.imagen %>" alt="Petition Image" class="petition-image">
                <p><strong>ID:#</strong>
                  <%= peticion.idPeticion %>
                </p>
                <p><strong>Requerida por:</strong>
                  <%= peticion.requeridaPor %>
                </p>
                <p><strong>Asignada a:</strong>
                  <%= peticion.asignadaa %>
                </p>
                <p><strong>Prioridad:</strong>
                  <%= peticion.prioridad %>
                </p>
                <p><strong>Estado:</strong>
                  <%= peticion.estado %>
                </p>
                <div class="card-actions">
                  <button class="approve-btn"><i class="fas fa-check"></i></button>
                  <button class="assign-btn"><i class="fas fa-user-plus"></i></button>
                  <button class="comment-btn"><i class="fas fa-comment"></i></button>
                </div>
              </div>
              <% } %>
          </div>
        </div>
      </div>
      <script> var todos = [];</script>
      <% for(let peticion of todasLasPeticiones) { %>
        <script>
          todos.push({ id: '<%= peticion.tipo %>', nombre: '<%= peticion.comentarios %>' });
          //console.log(todos);
        </script>
        <% } %>
    </main>
    <%- include('../components/common/footer.ejs') %>
  </body>